# TODO: The scripts for saving sessions barely work
# if you face issues refactor it

# Fix terminal key issues
set -s extended-keys on
set -as terminal-features 'xterm*:extkeys'
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"
set -ag terminal-overrides ",*:Tc"  # True color support
set -ag terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # Underline support
set -ag terminal-overrides ',*:Setulc=\E[58::5::%p1%dm'  # Underline color

# Ensure proper modifier key handling
set -g xterm-keys on
# Terminal end setup

source-file ~/.config/tmux/tmux.reset.conf
source-file ~/.config/tmux/tmux.keybinds.conf
# source-file ~/.config/tmux/tmux.vim.conf
set -a terminal-features "tmux-256color:RGB"
set -g prefix C-SPACE
set -g mouse on
# set -g prefix ^A
set -g base-index 1
set -g renumber-windows on   
set -g mode-keys vi
set -g status-position top
set -g status-justify absolute-centre
set -g status-style "bg=#11111b"
set -g window-status-current-style "fg=black bg=white  "
set -g status-interval 5
set -g status-left-length 100
# set -g status-left '-> #[fg=#9399b2 bg=#000]#{session_name}'
set -g status-left '> #[fg=#a6adc8]#{session_name}'
set-option -g message-style 'bg=#000000,fg=#ffffff'
# set -g status-right "#[fg=yellow,bold]#( apm -l )%%#[default] [#S]"
set -g status-right "#[fg=#a6adc8]DIR: #{b:pane_current_path}"

# All windows: dim gray text
set -g window-status-style 'fg=colour244'

# Active window: bright white, underlined, no background
set -g window-status-current-style 'fg=#f38ba8,underscore'

# Optional: Make last active window slightly brighter
set -g window-status-last-style 'fg=colour250'

# Optional: Remove window separators for cleaner lotmux list-sessions -F '#{session_name}' | fzf | xargs tmux switch-client -t
set -g window-status-separator " "

# bind r source-file "~/.config/tmux/tmux.conf"
bind b set -g status
# bind-key -n M-BSpace send-keys C-w
# bind f run "tmux neww ~/.config/scripts/tmux-session-dispensary.sh"
# bind g run "~/.config/scripts/open-github.sh"
# bind t run "tmux neww ~/.config/scripts/time.sh"
# bind N run "~/.config/scripts/tmux-session-dispensary.sh ~/documents/notes"
# bind P run "~/.config/scripts/tmux-session-dispensary.sh ~/documents/projects"
# bind D run "~/.config/scripts/tmux-session-dispensary.sh ~/.config"
# bind H run "~/.config/scripts/tmux-session-dispensary.sh ~"
# bind S run "~/.config/scripts/tmux-session-dispensary.sh ~/documents/projects/stormy"
# bind G neww -n "git" -S lazygit
# bind o neww -S -n "BOOKMARKS" "nvim ~/bookmarks.csv"
# bind e neww -S "nvim ~/bookmarks.csv"
bind E show-environment -g

# bind o run "tmux neww ~/.config/tmux/scripts/sessionizer"
bind o run "~/.config/tmux/scripts/sessionizer"
# bind s run "tmux neww ~/.config/tmux/scripts/tmux-save"
bind s run "~/.config/tmux/scripts/tmux-save"
bind-key -n C-s run "tmux neww ~/.config/tmux/scripts/tmux-save" \; display "Session saved!"
bind w run "~/.config/tmux/scripts/windownizer"

# source-file ~/.config/tmux/tmux.keybinds.conf
# source-file ~/.config/tmux/tmux.reset.conf
# set-option -g default-terminal 'screen-256color'
# set-option -g terminal-overrides ',xterm-256color:RGB'
#
# set -g prefix ^A
# set -g base-index 1              # start indexing windows at 1 instead of 0
# set -g detach-on-destroy off     # don't exit from tmux when closing a session
# set -g escape-time 0             # zero-out escape time delay
# set -g history-limit 1000000     # increase history size (from 2,000)
# set -g renumber-windows on       # renumber all windows when any window is closed
# set -g set-clipboard on          # use system clipboard
# set -g status-position top       # macOS / darwin style
# set -g default-terminal "${TERM}"
# setw -g mode-keys vi
# set -g pane-active-border-style 'fg=magenta,bg=default'
# set -g pane-border-style 'fg=brightblack,bg=default'
#
# set -g @fzf-url-fzf-options '-p 60%,30% --prompt="   " --border-label=" Open URL "'
# set -g @fzf-url-history-limit '2000'
#
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'
# set -g @plugin 'fcsonline/tmux-thumbs'
# set -g @plugin 'sainnhe/tmux-fzf'
# set -g @plugin 'wfxr/tmux-fzf-url'
# set -g @plugin 'omerxx/catppuccin-tmux' # My fork that holds the meetings script bc I'm lazy af
# set -g @plugin 'omerxx/tmux-sessionx'
# set -g @plugin 'omerxx/tmux-floax'
# set -g @floax-width '80%'
# set -g @floax-height '80%'
# set -g @floax-border-color 'magenta'
# set -g @floax-text-color 'blue'
# set -g @floax-bind 'p'
# set -g @floax-change-path 'true'
# set -g @sessionx-bind-zo-new-window 'ctrl-y'
# set -g @sessionx-auto-accept 'off'
# set -g @sessionx-custom-paths '/home/erick/.dotfiles/sessions'
# set -g @sessionx-bind 'o'
# set -g @sessionx-x-path '/home/erick/.dotfiles/sessions/x'
# set -g @sessionx-window-height '85%'
# set -g @sessionx-window-width '75%'
# set -g @sessionx-zoxide-mode 'on'
# set -g @sessionx-custom-paths-subdirectories 'false'
# set -g @sessionx-filter-current 'false'
# set -g @continuum-restore 'on'
# set -g @continuum-save-interval '5'
# set -g @resurrect-processes 'ssh nvim vim node python'
# set -g @resurrect-hook-pre-restore-pane-processes 'tmux switch-client -n && tmux kill-session -t=0'
# set -g @resurrect-strategy-nvim 'session'
# set -g @catppuccin_window_left_separator ""
# set -g @catppuccin_window_right_separator " "
# set -g @catppuccin_window_middle_separator " █"
# set -g @catppuccin_window_number_position "right"
# set -g @catppuccin_window_default_fill "number"
# set -g @catppuccin_window_default_text "#W"
# set -g @catppuccin_window_current_fill "number"
# set -g @catppuccin_window_current_text "#W#{?window_zoomed_flag,(),}"
# set -g @catppuccin_status_modules_right "directory" # date_time"
# set -g @catppuccin_status_modules_left "session"
# set -g @catppuccin_status_left_separator  " "
# set -g @catppuccin_status_right_separator " "
# set -g @catppuccin_status_right_separator_inverse "no"
# set -g @catppuccin_status_fill "icon"
# set -g @catppuccin_status_connect_separator "no"
# set -g @catppuccin_directory_text "#{b:pane_current_path}"
# # set -g @catppuccin_meetings_text "#($HOME/.config/tmux/scripts/cal.sh)"
# # set -g @catppuccin_date_time_text "%H:%M"
#
# run '~/.tmux/plugins/tpm/tpm'
